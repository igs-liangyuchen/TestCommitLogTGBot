name: Git Push Notification

on:
  push:
    branches:
      - main  # å¦‚æœä½ çš„ä¸»åˆ†æ”¯å« masterï¼Œè«‹æ”¹ç‚º master

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Get Commits
        id: get_commits
        run: |
          # å–å¾—æœ€å¾Œä¸€æ¬¡ push çš„æ‰€æœ‰ commit è¨Šæ¯
          COMMITS=$(git log -1 --pretty=format:"%s (by %an)")
          echo "MSG=$COMMITS" >> $GITHUB_ENV

      - name: Send Telegram Message
        run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "text=ğŸš€ **Git æ–°ä¸Šå‚³é€šçŸ¥**%0A%0AğŸ“ å…§å®¹ï¼š${{ env.MSG }}%0AğŸ”— å°ˆæ¡ˆï¼š${{ github.repository }}" \
            -d "parse_mode=Markdown"